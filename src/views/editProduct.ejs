<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head.ejs', {uploadFormCss: 'uploadForm' }) %>
  <body>
    <%- include('./partials/header.ejs') %>
    <main>
      <form class="form-login" action="/products/edit/<%= product.id %>?_method=PUT" method="POST" enctype="multipart/form-data">
        <div class="input-group">
          <label for="nombre">Nombre</label>
          <input type="text" id="name"name="name" value="<%= product.name %>" />
          <% if (locals.error && error.name) { %>
            <p>
              <%= error.name.msg %>
            </p>
          <% } %>
          <div id="errorName"></div>
        </div>
        <div class="input-group">
          <label for="description">Descripcion</label>
          <textarea name="description" id="description" rows="5"><%= product.description %></textarea>
          <% if (locals.error && error.description) { %>
            <p>
              <%= error.description.msg %>
            </p>
          <% } %>
          <div id="errorDescription"></div>
        </div>
        <div class="input-group">
          <label for="category">Categoria</label>
          <select name="category_id" id="category">
            <option value="" disabled selected> Selecciona Categoria</option>
            <% allCategories.forEach(categories => { %>
              <option value="<%= categories.id %>"><%= categories.name %></option>
            <% }) %>
          </select>
          <% if (locals.error && error.categories) { %>
            <p>
              <%= error.categories.msg %>
            </p>
          <% } %>
          <div id="errorCategory"></div>
        </div>
        <div class="input-group">
          <label for="amount">Cantidad</label>
          <input type="number" id="amount" name="amount" />
          <% if (locals.error && error.amount) { %>
            <p>
              <%= error.amount.msg %>
            </p>
          <% } %>
          <div id="errorAmount"></div>
        </div>
        <div class="input-group">
          <label for="price">Precio</label>
          <input type="number" id="price" name="price" required  value="<%= product.price %>"/>
          <% if (locals.error && error.price) { %>
            <p>
              <%= error.price.msg %>
            </p>
          <% } %>
          <div id="errorPrice"></div>
        </div>
        
        
        <% for( const propiedad in product.size) { %>

        <div class="input-group">
          <label for="cantidad_<%= propiedad %>">Cantidad talle <%= propiedad %> :</label>
          <input type="number" id="amount_<%= propiedad %>" name="amount"  value="<%= product.size[propiedad] %>"/>
          <div id="errorAmount"></div>
        </div>
        <% } %>
        <div class="input-container">
          <div class="input-group">
            <label for="color">Color</label>
            <select name="color_id" id="color">
              <option value="" disabled selected> Selecciona color</option
                <% allColors.forEach(color => { %>
                  <option value="<%= color.id %>"><%= color.name %></option>
                <% }) %>
            </select>
            <% if (locals.error && error.color) { %>
              <p>
                <%= error.color.msg %>
              </p>
            <% } %>
            <div id="errorColor"></div>
            <!-- <label for="color">Color</label>
            <select name="color" id="color">
              <option value="Negro">Negro</option>
              <option value="Blanco">Blanco</option>
              <option value="Azul">Azul</option>
              <option value="Rojo">Rojo</option>
            </select> -->
          </div> 
          <div class="input-group">
            <label for="size">Size</label>
            <select name="size_id" id="size">
              <option value="" disabled selected> Selecciona Talle</option>
                <% allSizes.forEach(size => { %>
                  <option value="<%= size.id %>"><%= size.name %></option>
                <% }) %>
            </select>
            <% if (locals.error && error.size) { %>
              <p>
                <%= error.size.msg %>
              </p>
            <% } %>
            <div id="errorSize"></div>
          </div>
        </div>
        <div class="input-group">
          <label for="">Seleccion√° una imagen</label>
          <input type="file" name="image_product" id="image_product" accept=".jpg" />
          <% if (locals.error && error.image_product) { %>
            <p>
              <%= error.image_product.msg %>
            </p>
          <% } %>
          <div id="errorImage"></div>
        </div>
        <div>
          <button type="submit" class="cargar">Guardar</button>
        </div>
      </form>
    </main>
    <%- include('./partials/footer.ejs') %>
    <script src="/js/createValidation.js"></script>
  </body>
</html>
